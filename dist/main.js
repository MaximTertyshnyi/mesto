(()=>{"use strict";class e{constructor(e){this._popupElement=document.querySelector(e)}openPopup(){this._popupElement.classList.add("popup_opened"),this._popupElement.addEventListener("mousedown",this._handleClickOnOverlayClose),document.addEventListener("keydown",this._handleEscClose)}closePopup(){this._popupElement.classList.remove("popup_opened"),this._popupElement.removeEventListener("mousedown",this._handleClickOnOverlayClose),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{if("Escape"===e.key){const e=document.querySelector(".popup_opened");this.closePopup(e)}};_handleClickOnOverlayClose=e=>{const t=document.querySelector(".popup_opened");e.target===t&&this.closePopup()};setEventListeners(){this._popupElement.querySelector(".popup__button-close").addEventListener("click",(()=>{this.closePopup()}))}}class t extends e{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popupElement.querySelector(".popup__form"),this._inputList=[...this._popupElement.querySelectorAll(".popup__input")]}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(()=>{this._handleSubmit(this._getInputValues()),this.closePopup()}))}closePopup(){super.closePopup()}}class s{constructor(e,t,s){this._name=e.name,this._link=e.link,this._templateSelector=t,this.operateCardClic=s}_getTemplate(){return this._templateSelector.content.querySelector(".element").cloneNode(!0)}_setEventListeners(){this._cardElement=this._getTemplate(),this._cardElement.querySelector(".element__like-button").addEventListener("click",this._toggleLike),this._cardElement.querySelector(".element__delite-button").addEventListener("click",this._deleteCard),this._cardElement.querySelector(".element__ithem").addEventListener("click",(()=>{this.operateCardClic()}))}_toggleLike=e=>{e.target.classList.toggle("element__like-button_active")};_deleteCard=()=>{this._cardElement.remove()};createCard=()=>(this._cardElement=this._getTemplate(),this._setEventListeners(),this._cardElement.querySelector(".element__ithem").src=this._link,this._cardElement.querySelector(".element__title").textContent=this._name,this._cardElement.querySelector(".element__ithem").alt=this._name,this._cardElement)}class n{constructor(e,t){this._formElement=t,this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError=(e,t)=>{const s=this._formElement.querySelector(`#${e.name}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)};_hideInputError=e=>{const t=this._formElement.querySelector(`#${e.name}-error`);e.classList.add(this._inputErrorClass),t.textContent="",e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass)};_checkInputValidity=e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)};_hasInvalidInput=()=>this._inputList.some((e=>!e.validity.valid));_toggleButtonState=()=>{this._hasInvalidInput()?(this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._inactiveButtonClass)):(this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._inactiveButtonClass))};_setEventListeners=()=>{this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))};enableValidation=()=>{this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const r={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},o=document.querySelector(".elements"),i=document.querySelector(".profile__title"),l=document.querySelector(".profile__subtitle"),p=document.querySelector(".element-template"),u=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),c=document.forms["user-profile"],_=document.forms["user-add"],d=document.querySelector(".popup__input_name"),m=document.querySelector(".popup__input_business"),h=new class{constructor({userName:e,userDescription:t}){this._userName=e,this._userDescription=t}getUserInfo(){return this._userProfile={name:this._userName.textContent,description:this._userDescription.textContent},this._userProfile}setUserInfo({profilename:e,description:t}){this._userName.textContent=e,this._userDescription.textContent=t}}({userName:i,userDescription:l});new n(r,c).enableValidation(),u.addEventListener("click",(function(){S.openPopup();const e=h.getUserInfo();d.value=e.name,m.value=e.description}));const E=new class extends e{constructor(e){super(e),this._link=this._popupElement.querySelector(".popup__img"),this._name=this._popupElement.querySelector(".popup__title-img")}openPopup({name:e,link:t}){this._link.src=t,this._name.textContent=e,this._name.alt=e,super.openPopup()}}(".popup_type_img");function v(e,t){return new s(e,t,(()=>{E.openPopup(e)})).createCard()}E.setEventListeners();const y=new class{constructor({items:e,renderer:t},s){this._renderer=t,this._renderItems=e,this._conteinerSelector=s}renderItems(){this._renderItems.forEach((e=>this._renderer(e)))}addItem(e){this._conteinerSelector.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=v(e,p);y.addItem(t)}},o);y.renderItems(),new n(r,_).enableValidation(),a.addEventListener("click",(function(){f.openPopup()}));const S=new t(".popup_type_edit",(e=>{h.setUserInfo(e)}));S.setEventListeners();const f=new t(".popup_type_add",(e=>{const t=v(e,p);y.addItem(t)}));f.setEventListeners(),new t(".popup_type_img").setEventListeners()})();